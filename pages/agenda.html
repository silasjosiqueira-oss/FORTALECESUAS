<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agenda - Sistema de Atendimento Social</title>

    <!-- CSS Externos -->
    <link rel="stylesheet" href="../css/base/reset.css">
    <link rel="stylesheet" href="../css/base/variables.css">
    <link rel="stylesheet" href="../css/base/typography.css">
    <link rel="stylesheet" href="../css/layout/sidebar.css">
    <link rel="stylesheet" href="../css/layout/header.css">
    <link rel="stylesheet" href="../css/layout/grid.css">
    <link rel="stylesheet" href="../css/layout/responsive.css">
    <link rel="stylesheet" href="../css/components/buttons.css">
    <link rel="stylesheet" href="../css/components/cards.css">
    <link rel="stylesheet" href="../css/components/forms.css">
    <link rel="stylesheet" href="../css/components/modal.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="/css/pages/agenda.css" />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- jsPDF para exportação PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>


</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar__header">
                <div class="sidebar__logo">FS</div>
                <h1 class="sidebar__title">FORTALECE SUAS</h1>
            </div>
            <nav class="sidebar__nav">
                <ul>
                    <li><a href="index.html"><i class="fas fa-tachometer-alt"></i><span>Inicio</span></a></li>
                    <li><a href="atendimento.html"><i class="fas fa-users"></i><span>Atendimentos</span></a></li>
                    <li><a href="beneficios.html"><i class="fas fa-hand-holding-heart"></i><span>Benefícios</span></a></li>
                    <li><a href="agenda.html" class="active"><i class="fas fa-calendar-alt"></i><span>Agenda</span></a></li>
                    <li><a href="atividades.html"><i class="fas fa-users-cog"></i><span>Grupos/Atividades</span></a></li>
                    <li><a href="programas.html"><i class="fas fa-clipboard-list"></i><span>Programas</span></a></li>
                    <li><a href="relatorios.html"><i class="fas fa-file-alt"></i><span>Relatórios</span></a></li>
                    <li><a href="estatisticas.html"><i class="fas fa-chart-bar"></i><span>Estatísticas</span></a></li>
                    <li><a href="cadastros.html"><i class="fas fa-database"></i><span>Cadastros</span></a></li>
                    <li><a href="estoque.html"><i class="fas fa-boxes"></i><span>Estoque</span></a></li>
                    <li><a href="ferramentas.html"><i class="fas fa-tools"></i><span>Ferramentas</span></a></li>
                    <li><a href="configuracoes.html"><i class="fas fa-cogs"></i><span>Configurações</span></a></li>
                    <li><a href="suporte.html"><i class="fas fa-life-ring"></i><span>Suporte</span></a></li>
                    <li><a href="login.html"><i class="fas fa-sign-out-alt"></i><span>Logoff</span></a></li>
                </ul>
            </nav>
        </aside>

        <!-- Conteúdo Principal -->
        <main class="main-content">
            <header class="main-header">
                <div class="header-title">
                    <h2>Sistema Fortalece - Assistência Social</h2>
                </div>
                <div class="header-actions">
                    <button class="btn btn--icon"><i class="fas fa-bell"></i><span class="badge">3</span></button>
                    <button class="btn btn--icon"><i class="fas fa-cog"></i></button>
                    <button class="btn btn--secondary" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Sair</button>
                </div>
            </header>

            <div class="content-wrapper">
                <!-- Tabs -->
                <div class="tabs">
                    <div class="tab active" data-tab="calendario">Calendário</div>
                    <div class="tab" data-tab="agendamentos">Agendamentos</div>
                    <div class="tab" data-tab="atividades">Atividades Coletivas</div>
                    <div class="tab" data-tab="institucional">Agenda Institucional</div>
                </div>

                <!-- Aba Calendário -->
                <div class="tab-content active" id="tab-calendario">
                    <div class="card">
                        <div class="card-header">
                            <h3>Agenda do Mês</h3>
                            <div class="calendar-actions">
                                <button class="btn btn--outline" id="btn-mes-anterior">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <span class="current-month">Carregando...</span>
                                <button class="btn btn--outline" id="btn-mes-proximo">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                                <button class="btn btn--primary" id="btn-novo-evento">
                                    <i class="fas fa-plus"></i> Novo
                                </button>
                                <button class="btn btn--success" onclick="agendaManager.imprimirCalendario()">
                                    <i class="fas fa-print"></i> Imprimir
                                </button>
                                <button class="btn btn--info" onclick="agendaManager.baixarPDF('calendario')">
                                    <i class="fas fa-file-pdf"></i> PDF
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="calendar-weekdays">
                                <div>Dom</div>
                                <div>Seg</div>
                                <div>Ter</div>
                                <div>Qua</div>
                                <div>Qui</div>
                                <div>Sex</div>
                                <div>Sáb</div>
                            </div>
                            <div class="calendar" id="calendar-grid"></div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>Próximos Eventos</h3>
                            <button class="btn btn--outline" onclick="agendaManager.carregarEventos()">
                                <i class="fas fa-sync-alt"></i> Atualizar
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="event-list" id="proximos-eventos">
                                <p>Carregando eventos...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Aba Agendamentos -->
                <div class="tab-content" id="tab-agendamentos">
                    <div class="card">
                        <div class="card-header">
                            <h3>Agendamentos de Usuários</h3>
                            <div class="export-buttons">
                                <button class="btn btn--primary" id="btn-novo-agendamento">
                                    <i class="fas fa-plus"></i> Novo
                                </button>
                                <button class="btn btn--success" onclick="agendaManager.imprimirAgendamentos()">
                                    <i class="fas fa-print"></i> Imprimir
                                </button>
                                <button class="btn btn--info" onclick="agendaManager.baixarPDF('agendamentos')">
                                    <i class="fas fa-file-pdf"></i> PDF
                                </button>
                                <button class="btn btn--warning" onclick="agendaManager.gerarRelatorioAgendamentos()">
                                    <i class="fas fa-chart-bar"></i> Relatório
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- Filtros -->
                            <div class="filter-section">
                                <h4><i class="fas fa-filter"></i> Filtros</h4>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label class="form-label">Data Inicial</label>
                                        <input type="date" class="form-input" id="filtro-data-inicial">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Data Final</label>
                                        <input type="date" class="form-input" id="filtro-data-final">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Unidade</label>
                                        <select class="form-input" id="filtro-unidade">
                                            <option value="">Todas</option>
                                            <option value="CRAS Centro">CRAS Centro</option>
                                            <option value="CRAS Norte">CRAS Norte</option>
                                            <option value="CRAS Sul">CRAS Sul</option>
                                            <option value="CREAS">CREAS</option>
                                            <option value="Secretaria">Secretaria</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Status</label>
                                        <select class="form-input" id="filtro-status">
                                            <option value="">Todos</option>
                                            <option value="agendado">Agendado</option>
                                            <option value="confirmado">Confirmado</option>
                                            <option value="realizado">Realizado</option>
                                            <option value="cancelado">Cancelado</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button class="btn btn--primary" onclick="agendaManager.filtrarAgendamentos()">
                                        <i class="fas fa-search"></i> Pesquisar
                                    </button>
                                    <button class="btn btn--outline" onclick="agendaManager.limparFiltros()">
                                        <i class="fas fa-times"></i> Limpar
                                    </button>
                                </div>
                            </div>

                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Data/Hora</th>
                                            <th>Usuário</th>
                                            <th>Serviço</th>
                                            <th>Unidade</th>
                                            <th>Formato</th>
                                            <th>Profissional</th>
                                            <th>Status</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabela-agendamentos">
                                        <tr><td colspan="8">Carregando...</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Aba Atividades -->
                <div class="tab-content" id="tab-atividades">
                    <div class="card">
                        <div class="card-header">
                            <h3>Atividades Coletivas</h3>
                            <div class="export-buttons">
                                <button class="btn btn--primary" id="btn-nova-atividade">
                                    <i class="fas fa-plus"></i> Nova
                                </button>
                                <button class="btn btn--success" onclick="agendaManager.imprimirAtividades()">
                                    <i class="fas fa-print"></i> Imprimir
                                </button>
                                <button class="btn btn--info" onclick="agendaManager.baixarPDF('atividades')">
                                    <i class="fas fa-file-pdf"></i> PDF
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Atividade</th>
                                            <th>Descrição</th>
                                            <th>Dia/Horário</th>
                                            <th>Unidade</th>
                                            <th>Participantes</th>
                                            <th>Coordenador</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabela-atividades">
                                        <tr><td colspan="7">Carregando...</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Aba Institucional -->
                <div class="tab-content" id="tab-institucional">
                    <div class="card">
                        <div class="card-header">
                            <h3>Agenda Institucional</h3>
                            <div class="export-buttons">
                                <button class="btn btn--primary" id="btn-novo-institucional">
                                    <i class="fas fa-plus"></i> Novo
                                </button>
                                <button class="btn btn--success" onclick="agendaManager.imprimirInstitucional()">
                                    <i class="fas fa-print"></i> Imprimir
                                </button>
                                <button class="btn btn--info" onclick="agendaManager.baixarPDF('institucional')">
                                    <i class="fas fa-file-pdf"></i> PDF
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="event-list" id="lista-institucional">
                                <p>Carregando eventos...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal Novo Evento -->
    <div id="modal-novo-evento" class="modal">
        <div class="modal__content" style="max-width: 700px;">
            <button class="modal__close" onclick="agendaManager.fecharModal('modal-novo-evento')">&times;</button>
            <div class="modal__header">
                <h2>Novo Evento</h2>
            </div>
            <div class="modal__body">
                <form id="form-novo-evento">
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Tipo *</label>
                            <select class="form-input" name="tipo" required>
                                <option value="">Selecione...</option>
                                <option value="agendamento">Agendamento</option>
                                <option value="atividade">Atividade</option>
                                <option value="reuniao">Reunião</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Unidade *</label>
                            <select class="form-input" name="unidade" required>
                                <option value="">Selecione...</option>
                                <option value="CRAS Centro">CRAS Centro</option>
                                <option value="CRAS Norte">CRAS Norte</option>
                                <option value="CRAS Sul">CRAS Sul</option>
                                <option value="CREAS">CREAS</option>
                                <option value="Secretaria">Secretaria</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Data *</label>
                            <input type="date" class="form-input" name="data" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Hora *</label>
                            <input type="time" class="form-input" name="hora" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Título *</label>
                        <input type="text" class="form-input" name="titulo" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Descrição</label>
                        <textarea class="form-input" name="descricao" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" onclick="agendaManager.fecharModal('modal-novo-evento')">Cancelar</button>
                <button class="btn btn--primary" onclick="agendaManager.salvarEvento()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Novo Agendamento -->
    <div id="modal-novo-agendamento" class="modal">
        <div class="modal__content" style="max-width: 700px;">
            <button class="modal__close" onclick="agendaManager.fecharModal('modal-novo-agendamento')">&times;</button>
            <div class="modal__header">
                <h2>Novo Agendamento</h2>
            </div>
            <div class="modal__body">
                <form id="form-novo-agendamento">
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Usuário *</label>
                            <input type="text" class="form-input" name="usuario" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">CPF/NIS</label>
                            <input type="text" class="form-input" name="cpf_nis">
                        </div>
                    </div>
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Serviço *</label>
                            <input type="text" class="form-input" name="servico" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Unidade *</label>
                            <select class="form-input" name="unidade" required>
                                <option value="">Selecione...</option>
                                <option value="CRAS Centro">CRAS Centro</option>
                                <option value="CRAS Norte">CRAS Norte</option>
                                <option value="CRAS Sul">CRAS Sul</option>
                                <option value="CREAS">CREAS</option>
                                <option value="Secretaria">Secretaria</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Formato *</label>
                            <select class="form-input" name="formato" required>
                                <option value="">Selecione...</option>
                                <option value="Presencial">Presencial</option>
                                <option value="Telefone">Telefone</option>
                                <option value="Virtual">Virtual (Vídeo)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Profissional</label>
                            <input type="text" class="form-input" name="profissional">
                        </div>
                    </div>
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Data *</label>
                            <input type="date" class="form-input" name="data" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Hora *</label>
                            <input type="time" class="form-input" name="hora" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Observações</label>
                        <textarea class="form-input" name="observacoes" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" onclick="agendaManager.fecharModal('modal-novo-agendamento')">Cancelar</button>
                <button class="btn btn--primary" onclick="agendaManager.salvarAgendamento()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Nova Atividade -->
    <div id="modal-nova-atividade" class="modal">
        <div class="modal__content" style="max-width: 700px;">
            <button class="modal__close" onclick="agendaManager.fecharModal('modal-nova-atividade')">&times;</button>
            <div class="modal__header">
                <h2>Nova Atividade Coletiva</h2>
            </div>
            <div class="modal__body">
                <form id="form-nova-atividade">
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Atividade *</label>
                            <input type="text" class="form-input" name="titulo" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Unidade *</label>
                            <select class="form-input" name="unidade" required>
                                <option value="">Selecione...</option>
                                <option value="CRAS Centro">CRAS Centro</option>
                                <option value="CRAS Norte">CRAS Norte</option>
                                <option value="CRAS Sul">CRAS Sul</option>
                                <option value="CREAS">CREAS</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Descrição</label>
                        <textarea class="form-input" name="descricao" rows="2"></textarea>
                    </div>
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Dia da Semana *</label>
                            <select class="form-input" name="dia_semana" required>
                                <option value="">Selecione...</option>
                                <option value="Segundas">Segundas-feiras</option>
                                <option value="Terças">Terças-feiras</option>
                                <option value="Quartas">Quartas-feiras</option>
                                <option value="Quintas">Quintas-feiras</option>
                                <option value="Sextas">Sextas-feiras</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Horário *</label>
                            <input type="text" class="form-input" name="horario" placeholder="Ex: 14:00-16:00" required>
                        </div>
                    </div>
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Coordenador/Educador *</label>
                            <input type="text" class="form-input" name="coordenador" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Vagas</label>
                            <input type="number" class="form-input" name="vagas" min="1" value="15">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Observações</label>
                        <textarea class="form-input" name="observacoes" rows="2"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" onclick="agendaManager.fecharModal('modal-nova-atividade')">Cancelar</button>
                <button class="btn btn--primary" onclick="agendaManager.salvarAtividade()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Novo Institucional -->
    <div id="modal-novo-institucional" class="modal">
        <div class="modal__content" style="max-width: 700px;">
            <button class="modal__close" onclick="agendaManager.fecharModal('modal-novo-institucional')">&times;</button>
            <div class="modal__header">
                <h2>Novo Evento Institucional</h2>
            </div>
            <div class="modal__body">
                <form id="form-novo-institucional">
                    <div class="form-group">
                        <label class="form-label">Título *</label>
                        <input type="text" class="form-input" name="titulo" required>
                    </div>
                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Data *</label>
                            <input type="date" class="form-input" name="data" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Horário *</label>
                            <input type="time" class="form-input" name="hora" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Pauta *</label>
                        <textarea class="form-input" name="pauta" rows="3" required placeholder="Descreva a pauta da reunião..."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Quem irá Representar *</label>
                        <textarea class="form-input" name="representantes" rows="2" required placeholder="Liste os órgãos/pessoas que participarão..."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Local</label>
                        <input type="text" class="form-input" name="local" placeholder="Ex: Sala de reuniões - CRAS Centro">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Observações</label>
                        <textarea class="form-input" name="observacoes" rows="2"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" onclick="agendaManager.fecharModal('modal-novo-institucional')">Cancelar</button>
                <button class="btn btn--primary" onclick="agendaManager.salvarInstitucional()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Lista de Presença -->
    <div id="modal-lista-presenca" class="modal">
        <div class="modal__content" style="max-width: 600px;">
            <button class="modal__close" onclick="agendaManager.fecharModal('modal-lista-presenca')">&times;</button>
            <div class="modal__header">
                <h2>Lista de Presença</h2>
            </div>
            <div class="modal__body">
                <div id="presenca-info"></div>
                <div class="presenca-list" id="lista-presenca-container">
                    <!-- Gerado dinamicamente -->
                </div>
                <div style="margin-top: 1rem;">
                    <button class="btn btn--success" onclick="agendaManager.imprimirListaPresenca()">
                        <i class="fas fa-print"></i> Imprimir Lista
                    </button>
                    <button class="btn btn--info" onclick="agendaManager.exportarPresencaExcel()">
                        <i class="fas fa-file-excel"></i> Exportar Excel
                    </button>
                </div>
            </div>
            <div class="modal__footer">
                <button class="btn btn--primary" onclick="agendaManager.fecharModal('modal-lista-presenca')">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading" id="loading-overlay">
        <div style="text-align: center;">
            <div class="spinner"></div>
            <h4>Carregando...</h4>
        </div>
    </div>

<script src="/src/js/agenda.app.js"></script>
</body>
</html>
