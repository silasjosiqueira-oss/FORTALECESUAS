<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grupos e Atividades - Sistema de Assistência Social</title>

    <!-- CSS Structure -->
    <link rel="stylesheet" href="../css/base/reset.css">
    <link rel="stylesheet" href="../css/base/variables.css">
    <link rel="stylesheet" href="../css/base/typography.css">
    <link rel="stylesheet" href="../css/layout/sidebar.css">
    <link rel="stylesheet" href="../css/layout/header.css">
    <link rel="stylesheet" href="../css/layout/grid.css">
    <link rel="stylesheet" href="../css/layout/responsive.css">
    <link rel="stylesheet" href="../css/components/buttons.css">
    <link rel="stylesheet" href="../css/components/cards.css">
    <link rel="stylesheet" href="../css/components/forms.css">
    <link rel="stylesheet" href="../css/components/modal.css">
    <link rel="stylesheet" href="/css/pages/atividades.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar__header">
                <div class="sidebar__logo">FS</div>
                <h1 class="sidebar__title">Fortalece SUAS</h1>
            </div>
            <nav class="sidebar__nav">
                <ul>
                    <li><a href="index.html"><i class="fas fa-tachometer-alt"></i><span>Início</span></a></li>
                    <li><a href="atendimento.html"><i class="fas fa-users"></i><span>Atendimentos</span></a></li>
                    <li><a href="beneficios.html"><i class="fas fa-hand-holding-heart"></i><span>Benefícios</span></a></li>
                    <li><a href="agenda.html"><i class="fas fa-calendar-alt"></i><span>Agenda</span></a></li>
                    <li><a href="atividades.html" class="active"><i class="fas fa-users-cog"></i><span>Grupos/Atividades</span></a></li>
                    <li><a href="programas.html"><i class="fas fa-clipboard-list"></i><span>Programas</span></a></li>
                    <li><a href="relatorios.html"><i class="fas fa-file-alt"></i><span>Relatórios</span></a></li>
                    <li><a href="estatisticas.html"><i class="fas fa-chart-bar"></i><span>Estatísticas</span></a></li>
                    <li><a href="cadastros.html"><i class="fas fa-database"></i><span>Cadastros</span></a></li>
                    <li><a href="estoque.html"><i class="fas fa-boxes"></i><span>Estoque</span></a></li>
                    <li><a href="ferramentas.html"><i class="fas fa-tools"></i><span>Ferramentas</span></a></li>
                    <li><a href="configuracoes.html"><i class="fas fa-cogs"></i><span>Configurações</span></a></li>
                    <li><a href="suporte.html"><i class="fas fa-life-ring"></i><span>Suporte</span></a></li>
                    <li><a href="login.html"><i class="fas fa-sign-out-alt"></i><span>Logoff</span></a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <div class="header-title">
                    <h2>Grupos e Atividades / Oficinas / Cursos</h2>
                    <p class="header-subtitle">Gestão completa de atividades coletivas do SUAS</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn--primary" onclick="openModal('modalNovoGrupo')">
                        <i class="fas fa-plus"></i> Nova Atividade
                    </button>
                </div>
            </header>

            <div class="content-wrapper">
                <!-- Statistics Cards -->
                <div class="stats-cards">
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div>
                                <div class="stat-value" id="totalGrupos">0</div>
                                <div class="stat-label">Total de Atividades</div>
                            </div>
                            <div class="stat-icon primary">
                                <i class="fas fa-users-cog"></i>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div>
                                <div class="stat-value" id="gruposAtivos">0</div>
                                <div class="stat-label">Atividades Ativas</div>
                            </div>
                            <div class="stat-icon success">
                                <i class="fas fa-play-circle"></i>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div>
                                <div class="stat-value" id="totalParticipantes">0</div>
                                <div class="stat-label">Total Participantes</div>
                            </div>
                            <div class="stat-icon info">
                                <i class="fas fa-users"></i>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div>
                                <div class="stat-value" id="atividadesHoje">0</div>
                                <div class="stat-label">Atividades Hoje</div>
                            </div>
                            <div class="stat-icon warning">
                                <i class="fas fa-calendar-day"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Filters -->
                <div class="filters-bar">
                    <div class="filters-grid">
                        <div class="form-group">
                            <label class="form-label">Buscar</label>
                            <input type="text" class="form-control" id="filtroNome" placeholder="Nome da atividade">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Responsável</label>
                            <input type="text" class="form-control" id="filtroResponsavel" placeholder="Nome do responsável">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Unidade</label>
                            <select class="form-control" id="filtroUnidade">
                                <option value="">Todas as unidades</option>
                                <option value="CRAS Centro">CRAS Centro</option>
                                <option value="CRAS Vila Nova">CRAS Vila Nova</option>
                                <option value="CREAS">CREAS</option>
                                <option value="Secretaria">Secretaria</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-control" id="filtroStatus">
                                <option value="">Todos os status</option>
                                <option value="ativo">Ativo</option>
                                <option value="inativo">Inativo</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">&nbsp;</label>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn--primary" onclick="gruposManager.aplicarFiltros()">
                                    <i class="fas fa-search"></i> Pesquisar
                                </button>
                                <button class="btn btn--secondary" onclick="gruposManager.limparFiltros()">
                                    <i class="fas fa-times"></i> Limpar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Groups List -->
                <div id="gruposList"></div>
            </div>
        </main>
    </div>

    <!-- Modal Nova Atividade -->
    <div id="modalNovoGrupo" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-plus"></i> Nova Atividade/Oficina/Curso</h3>
                <button class="btn-close" onclick="closeModal('modalNovoGrupo')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="formNovoGrupo">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Nome da Atividade *</label>
                            <input type="text" class="form-control" name="atividade" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Responsável/Coordenador *</label>
                            <input type="text" class="form-control" name="responsavel" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Educador/Oficineiro</label>
                            <input type="text" class="form-control" name="educador">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Unidade *</label>
                            <select class="form-control" name="unidade" required>
                                <option value="">Selecione</option>
                                <option value="CRAS Centro">CRAS Centro</option>
                                <option value="CRAS Vila Nova">CRAS Vila Nova</option>
                                <option value="CREAS">CREAS</option>
                                <option value="Secretaria">Secretaria de Assistência</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Localidade</label>
                            <input type="text" class="form-control" name="localidade" placeholder="Ex: Sala 3, Ginásio">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Dia da Semana *</label>
                            <select class="form-control" name="dia" required>
                                <option value="">Selecione</option>
                                <option value="Segunda">Segunda-feira</option>
                                <option value="Terça">Terça-feira</option>
                                <option value="Quarta">Quarta-feira</option>
                                <option value="Quinta">Quinta-feira</option>
                                <option value="Sexta">Sexta-feira</option>
                                <option value="Sábado">Sábado</option>
                                <option value="Domingo">Domingo</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Horário *</label>
                            <input type="text" class="form-control" name="horario" placeholder="Ex: 14:00-16:00" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Carga Horária Semanal</label>
                            <input type="number" class="form-control" name="cargaHoraria" placeholder="Horas">
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Data Início</label>
                            <input type="date" class="form-control" name="dataInicio">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Data Término (Previsão)</label>
                            <input type="date" class="form-control" name="dataTermino">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Vagas Disponíveis</label>
                            <input type="number" class="form-control" name="vagas" min="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-control" name="status">
                                <option value="ativo">Ativo</option>
                                <option value="inativo">Inativo</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Descrição/Objetivo</label>
                        <textarea class="form-control" name="descricao" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" onclick="closeModal('modalNovoGrupo')">Cancelar</button>
                <button class="btn btn--primary" onclick="gruposManager.salvarGrupo()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Detalhes da Atividade -->
    <div id="modalDetalhes" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 class="modal-title" id="detalhesTitle"><i class="fas fa-info-circle"></i> Detalhes da Atividade</h3>
                <button class="btn-close" onclick="closeModal('modalDetalhes')">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Informações gerais -->
                <div id="detalhesInfo"></div>

                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab-btn active" onclick="gruposManager.showTab('participantes')">
                        <i class="fas fa-users"></i> Participantes (<span id="totalParticipantesTab">0</span>)
                    </button>
                    <button class="tab-btn" onclick="gruposManager.showTab('presenca')">
                        <i class="fas fa-clipboard-check"></i> Lista de Presença
                    </button>
                    <button class="tab-btn" onclick="gruposManager.showTab('relatorios')">
                        <i class="fas fa-file-alt"></i> Relatórios
                    </button>
                </div>

                <!-- Tab Participantes -->
                <div id="tabParticipantes" class="tab-content active">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                        <h4>Lista de Participantes</h4>
                        <button class="btn btn--success btn-sm" onclick="gruposManager.abrirModalNovoParticipante()">
                            <i class="fas fa-user-plus"></i> Incluir Participante
                        </button>
                    </div>

                    <div class="form-group">
                        <input type="text" class="form-control" id="buscaParticipante" placeholder="Buscar participante por nome ou CPF...">
                    </div>

                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>CPF</th>
                                    <th>Data Entrada</th>
                                    <th>Situação</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="listaParticipantes">
                                <tr>
                                    <td colspan="5" style="text-align: center; padding: 2rem; color: #64748b;">
                                        Nenhum participante cadastrado
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Tab Presença -->
                <div id="tabPresenca" class="tab-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h4>Registro de Presença</h4>
                        <div style="display: flex; gap: 0.5rem;">
                            <input type="date" class="form-control" id="dataPresenca" style="width: auto;">
                            <button class="btn btn--primary btn-sm" onclick="gruposManager.registrarPresenca()">
                                <i class="fas fa-check"></i> Registrar Presença
                            </button>
                            <button class="btn btn--warning btn-sm" onclick="gruposManager.imprimirListaPresenca()">
                                <i class="fas fa-print"></i> Imprimir Lista
                            </button>
                        </div>
                    </div>

                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Participante</th>
                                    <th>Data</th>
                                    <th>Presença</th>
                                    <th>Observação</th>
                                </tr>
                            </thead>
                            <tbody id="listaPresencas">
                                <tr>
                                    <td colspan="4" style="text-align: center; padding: 2rem; color: #64748b;">
                                        Selecione uma data para ver a lista de presença
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Estatísticas de frequência -->
                    <div style="margin-top: 2rem; padding: 1rem; background: #f8fafc; border-radius: 8px;">
                        <h4 style="margin-bottom: 1rem;">Estatísticas de Frequência</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div class="info-item">
                                <div class="info-value" id="totalEncontros">0</div>
                                <div class="info-label">Total de Encontros</div>
                            </div>
                            <div class="info-item">
                                <div class="info-value" id="mediaPresenca">0%</div>
                                <div class="info-label">Média de Presença</div>
                            </div>
                            <div class="info-item">
                                <div class="info-value" id="totalFaltas">0</div>
                                <div class="info-label">Total de Faltas</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Relatórios -->
                <div id="tabRelatorios" class="tab-content">
                    <h4 style="margin-bottom: 1rem;">Relatórios e Exportações</h4>

                    <div style="display: grid; gap: 1rem;">
                        <button class="btn btn--primary" onclick="gruposManager.gerarRelatorioCompleto()">
                            <i class="fas fa-file-pdf"></i> Relatório Completo da Atividade
                        </button>
                        <button class="btn btn--info" onclick="gruposManager.exportarParticipantes()">
                            <i class="fas fa-file-excel"></i> Exportar Lista de Participantes (Excel)
                        </button>
                        <button class="btn btn--warning" onclick="gruposManager.gerarRelatorioFrequencia()">
                            <i class="fas fa-chart-bar"></i> Relatório de Frequência
                        </button>
                        <button class="btn btn--success" onclick="gruposManager.gerarCertificados()">
                            <i class="fas fa-certificate"></i> Gerar Certificados
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" onclick="closeModal('modalDetalhes')">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Modal Novo Participante -->
    <div id="modalNovoParticipante" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-user-plus"></i> Incluir Participante</h3>
                <button class="btn-close" onclick="closeModal('modalNovoParticipante')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="formNovoParticipante">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Nome Completo *</label>
                            <input type="text" class="form-control" name="nome" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">CPF *</label>
                            <input type="text" class="form-control" name="cpf" required>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Data de Nascimento</label>
                            <input type="date" class="form-control" name="dataNascimento">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Telefone</label>
                            <input type="tel" class="form-control" name="telefone">
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Data de Entrada *</label>
                            <input type="date" class="form-control" name="dataEntrada" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Situação</label>
                            <select class="form-control" name="situacao">
                                <option value="ativo">Ativo</option>
                                <option value="desligado">Desligado</option>
                                <option value="suspenso">Suspenso</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Observações</label>
                        <textarea class="form-control" name="observacoes" rows="2"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" onclick="closeModal('modalNovoParticipante')">Cancelar</button>
                <button class="btn btn--success" onclick="gruposManager.salvarParticipante()">Incluir Participante</button>
            </div>
        </div>
    </div>

    <!-- Modal Editar Atividade -->
    <div id="modalEditarGrupo" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-edit"></i> Editar Atividade</h3>
                <button class="btn-close" onclick="closeModal('modalEditarGrupo')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="formEditarGrupo">
                    <input type="hidden" name="id" id="editId">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Nome da Atividade *</label>
                            <input type="text" class="form-control" name="atividade" id="editAtividade" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Responsável *</label>
                            <input type="text" class="form-control" name="responsavel" id="editResponsavel" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Educador</label>
                            <input type="text" class="form-control" name="educador" id="editEducador">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Unidade *</label>
                            <select class="form-control" name="unidade" id="editUnidade" required>
                                <option value="">Selecione</option>
                                <option value="CRAS Centro">CRAS Centro</option>
                                <option value="CRAS Vila Nova">CRAS Vila Nova</option>
                                <option value="CREAS">CREAS</option>
                                <option value="Secretaria">Secretaria</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Localidade</label>
                            <input type="text" class="form-control" name="localidade" id="editLocalidade">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Dia da Semana *</label>
                            <select class="form-control" name="dia" id="editDia" required>
                                <option value="">Selecione</option>
                                <option value="Segunda">Segunda-feira</option>
                                <option value="Terça">Terça-feira</option>
                                <option value="Quarta">Quarta-feira</option>
                                <option value="Quinta">Quinta-feira</option>
                                <option value="Sexta">Sexta-feira</option>
                                <option value="Sábado">Sábado</option>
                                <option value="Domingo">Domingo</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Horário *</label>
                            <input type="text" class="form-control" name="horario" id="editHorario" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Carga Horária</label>
                            <input type="number" class="form-control" name="cargaHoraria" id="editCargaHoraria">
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Data Início</label>
                            <input type="date" class="form-control" name="dataInicio" id="editDataInicio">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Data Término</label>
                            <input type="date" class="form-control" name="dataTermino" id="editDataTermino">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Vagas</label>
                            <input type="number" class="form-control" name="vagas" id="editVagas">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-control" name="status" id="editStatus">
                                <option value="ativo">Ativo</option>
                                <option value="inativo">Inativo</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Descrição</label>
                        <textarea class="form-control" name="descricao" id="editDescricao" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" onclick="closeModal('modalEditarGrupo')">Cancelar</button>
                <button class="btn btn--primary" onclick="gruposManager.atualizarGrupo()">Atualizar</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div style="text-align: center;">
            <div class="spinner"></div>
            <h4>Carregando...</h4>
            <p id="loading-message">Aguarde</p>
        </div>
    </div>

    <!-- Notifications Container -->
    <div id="notifications-container" style="position: fixed; top: 20px; right: 20px; z-index: 10000;"></div>

<script src="/src/js/atividades.app.js"></script>
</body>
</html>
